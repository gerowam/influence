<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on April 2, 2015 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Untitled Document</title>

<meta name="description" content="Untitled Document">
<meta name="keywords" content="Untitled Document">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="index-histograms"></a>
<a name="index-binning-data"></a>
<p>This chapter describes functions for creating histograms.  Histograms
provide a convenient way of summarizing the distribution of a set of
data. A histogram consists of a set of <em>bins</em> which count the number
of events falling into a given range of a continuous variable <em>x</em>.
In GSL the bins of a histogram contain floating-point numbers, so they
can be used to record both integer and non-integer distributions.  The
bins can use arbitrary sets of ranges (uniformly spaced bins are the
default).  Both one and two-dimensional histograms are supported.
</p>
<p>Once a histogram has been created it can also be converted into a
probability distribution function.  The library provides efficient
routines for selecting random samples from probability distributions.
This can be useful for generating simulations based on real data.
</p>
<p>The functions are declared in the header files &lsquo;<tt>gsl_histogram.h</tt>&rsquo;
and &lsquo;<tt>gsl_histogram2d.h</tt>&rsquo;.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-histogram-struct">1. The histogram struct</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
<tr><td align="left" valign="top"><a href="#Histogram-allocation">2. Histogram allocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
<tr><td align="left" valign="top"><a href="#Copying-Histograms">3. Copying Histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
<tr><td align="left" valign="top"><a href="#Updating-and-accessing-histogram-elements">4. Updating and accessing histogram elements</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Searching-histogram-ranges">5. Searching histogram ranges</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Histogram-Statistics">6. Histogram Statistics</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
<tr><td align="left" valign="top"><a href="#Histogram-Operations">7. Histogram Operations</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
<tr><td align="left" valign="top"><a href="#Reading-and-writing-histograms">8. Reading and writing histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Resampling-from-histograms">9. Resampling from histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#The-histogram-probability-distribution-struct">10. The histogram probability distribution struct</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Example-programs-for-histograms">11. Example programs for histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Two-dimensional-histograms">12. Two dimensional histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#The-2D-histogram-struct">13. The 2D histogram struct</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#g_t2D-Histogram-allocation">14. 2D Histogram allocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Copying-2D-Histograms">15. Copying 2D Histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       
</td></tr>
<tr><td align="left" valign="top"><a href="#Updating-and-accessing-2D-histogram-elements">16. Updating and accessing 2D histogram elements</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Searching-2D-histogram-ranges">17. Searching 2D histogram ranges</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#g_t2D-Histogram-Statistics">18. 2D Histogram Statistics</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#g_t2D-Histogram-Operations">19. 2D Histogram Operations</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Reading-and-writing-2D-histograms">20. Reading and writing 2D histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Resampling-from-2D-histograms">21. Resampling from 2D histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Example-programs-for-2D-histograms">22. Example programs for 2D histograms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<a name="The-histogram-struct"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[ &lt; ]</td>
<td valign="middle" align="left">[<a href="#Histogram-allocation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[ &lt;&lt; ]</td>
<td valign="middle" align="left">[ Up ]</td>
<td valign="middle" align="left">[<a href="#Histogram-allocation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-histogram-struct-1"></a>
<h2 class="section">1. The histogram struct</h2>

<p>A histogram is defined by the following struct,
</p>
<dl>
<dt><a name="index-gsl_005fhistogram"></a><u>Data Type:</u> <b>gsl_histogram</b></dt>
<dd><dl compact="compact">
<dt> <code>size_t n</code></dt>
<dd><p>This is the number of histogram bins
</p></dd>
<dt> <code>double * range</code></dt>
<dd><p>The ranges of the bins are stored in an array of <em><var>n</var>+1</em> elements
pointed to by <var>range</var>.
</p></dd>
<dt> <code>double * bin</code></dt>
<dd><p>The counts for each bin are stored in an array of <var>n</var> elements
pointed to by <var>bin</var>.  The bins are floating-point numbers, so you can
increment them by non-integer values if necessary.
</p></dd>
</dl>
</dd></dl>

<p>The range for <var>bin</var>[i] is given by <var>range</var>[i] to
<var>range</var>[i+1].  For <em>n</em> bins there are <em>n+1</em> entries in the
array <var>range</var>.  Each bin is inclusive at the lower end and exclusive
at the upper end.  Mathematically this means that the bins are defined by
the following inequality,
Here is a diagram of the correspondence between ranges and bins on the
number-line for <em>x</em>,
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">
     [ bin[0] )[ bin[1] )[ bin[2] )[ bin[3] )[ bin[4] )
  ---|---------|---------|---------|---------|---------|---  x
   r[0]      r[1]      r[2]      r[3]      r[4]      r[5]

</pre></td></tr></table>

<p>In this picture the values of the <var>range</var> array are denoted by
<em>r</em>.  On the left-hand side of each bin the square bracket
&lsquo;<samp>[</samp>&rsquo; denotes an inclusive lower bound 
(<em>r &lt;= x</em>), and the round parentheses &lsquo;<samp>)</samp>&rsquo; on the right-hand
side denote an exclusive upper bound (<em>x &lt; r</em>).  Thus any samples
which fall on the upper end of the histogram are excluded.  If you want
to include this value for the last bin you will need to add an extra bin
to your histogram.
</p>
<p>The <code>gsl_histogram</code> struct and its associated functions are defined
in the header file &lsquo;<tt>gsl_histogram.h</tt>&rsquo;.
</p>
<hr size="6">
<a name="Histogram-allocation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-histogram-struct" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Copying-Histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Copying-Histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Histogram-allocation-1"></a>
<h2 class="section">2. Histogram allocation</h2>
<p>The functions for allocating memory to a histogram follow the style of
<code>malloc</code> and <code>free</code>.  In addition they also perform their own
error checking.  If there is insufficient memory available to allocate a
histogram then the functions call the error handler (with an error
number of <code>GSL_ENOMEM</code>) in addition to returning a null pointer.
Thus if you use the library error handler to abort your program then it
isn&rsquo;t necessary to check every histogram <code>alloc</code>.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram_005falloc"></a><u>Function:</u> gsl_histogram * <b>gsl_histogram_alloc</b><i> (size_t <var>n</var>)</i></dt>
<dd><p>This function allocates memory for a histogram with <var>n</var> bins, and
returns a pointer to a newly created <code>gsl_histogram</code> struct.  If
insufficient memory is available a null pointer is returned and the
error handler is invoked with an error code of <code>GSL_ENOMEM</code>. The
bins and ranges are not initialized, and should be prepared using one of
the range-setting functions below in order to make the histogram ready
for use.
</p></dd></dl>






<dl>
<dt><a name="index-gsl_005fhistogram_005fset_005franges"></a><u>Function:</u> int <b>gsl_histogram_set_ranges</b><i> (gsl_histogram * <var>h</var>, const double <var>range</var>[], size_t <var>size</var>)</i></dt>
<dd><p>This function sets the ranges of the existing histogram <var>h</var> using
the array <var>range</var> of size <var>size</var>.  The values of the histogram
bins are reset to zero.  The <code>range</code> array should contain the
desired bin limits.  The ranges can be arbitrary, subject to the
restriction that they are monotonically increasing.
</p>
<p>The following example shows how to create a histogram with logarithmic
bins with ranges [1,10), [10,100) and [100,1000).
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">gsl_histogram * h = gsl_histogram_alloc (3);

/* bin[0] covers the range 1 &lt;= x &lt; 10 */
/* bin[1] covers the range 10 &lt;= x &lt; 100 */
/* bin[2] covers the range 100 &lt;= x &lt; 1000 */

double range[4] = { 1.0, 10.0, 100.0, 1000.0 };

gsl_histogram_set_ranges (h, range, 4);
</pre></td></tr></table>

<p>Note that the size of the <var>range</var> array should be defined to be one
element bigger than the number of bins.  The additional element is
required for the upper value of the final bin.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fset_005franges_005funiform"></a><u>Function:</u> int <b>gsl_histogram_set_ranges_uniform</b><i> (gsl_histogram * <var>h</var>, double <var>xmin</var>, double <var>xmax</var>)</i></dt>
<dd><p>This function sets the ranges of the existing histogram <var>h</var> to cover
the range <var>xmin</var> to <var>xmax</var> uniformly.  The values of the
histogram bins are reset to zero.  The bin ranges are shown in the table
below,
where <em>d</em> is the bin spacing, <em>d = (xmax-xmin)/n</em>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005ffree"></a><u>Function:</u> void <b>gsl_histogram_free</b><i> (gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function frees the histogram <var>h</var> and all of the memory
associated with it.
</p></dd></dl>

<hr size="6">
<a name="Copying-Histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Histogram-allocation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Updating-and-accessing-histogram-elements" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Histogram-allocation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Updating-and-accessing-histogram-elements" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Copying-Histograms-1"></a>
<h2 class="section">3. Copying Histograms</h2>

<dl>
<dt><a name="index-gsl_005fhistogram_005fmemcpy"></a><u>Function:</u> int <b>gsl_histogram_memcpy</b><i> (gsl_histogram * <var>dest</var>, const gsl_histogram * <var>src</var>)</i></dt>
<dd><p>This function copies the histogram <var>src</var> into the pre-existing
histogram <var>dest</var>, making <var>dest</var> into an exact copy of <var>src</var>.
The two histograms must be of the same size.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fclone"></a><u>Function:</u> gsl_histogram * <b>gsl_histogram_clone</b><i> (const gsl_histogram * <var>src</var>)</i></dt>
<dd><p>This function returns a pointer to a newly created histogram which is an
exact copy of the histogram <var>src</var>.
</p></dd></dl>

<hr size="6">
<a name="Updating-and-accessing-histogram-elements"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Copying-Histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Searching-histogram-ranges" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Copying-Histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Searching-histogram-ranges" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Updating-and-accessing-histogram-elements-1"></a>
<h2 class="section">4. Updating and accessing histogram elements</h2>

<p>There are two ways to access histogram bins, either by specifying an
<em>x</em> coordinate or by using the bin-index directly.  The functions
for accessing the histogram through <em>x</em> coordinates use a binary
search to identify the bin which covers the appropriate range.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram_005fincrement"></a><u>Function:</u> int <b>gsl_histogram_increment</b><i> (gsl_histogram * <var>h</var>, double <var>x</var>)</i></dt>
<dd><p>This function updates the histogram <var>h</var> by adding one (1.0) to the
bin whose range contains the coordinate <var>x</var>. 
</p>
<p>If <var>x</var> lies in the valid range of the histogram then the function
returns zero to indicate success.  If <var>x</var> is less than the lower
limit of the histogram then the function returns <code>GSL_EDOM</code>, and
none of bins are modified.  Similarly, if the value of <var>x</var> is greater
than or equal to the upper limit of the histogram then the function
returns <code>GSL_EDOM</code>, and none of the bins are modified.  The error
handler is not called, however, since it is often necessary to compute
histograms for a small range of a larger dataset, ignoring the values
outside the range of interest.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005faccumulate"></a><u>Function:</u> int <b>gsl_histogram_accumulate</b><i> (gsl_histogram * <var>h</var>, double <var>x</var>, double <var>weight</var>)</i></dt>
<dd><p>This function is similar to <code>gsl_histogram_increment</code> but increases
the value of the appropriate bin in the histogram <var>h</var> by the
floating-point number <var>weight</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fget"></a><u>Function:</u> double <b>gsl_histogram_get</b><i> (const gsl_histogram * <var>h</var>, size_t <var>i</var>)</i></dt>
<dd><p>This function returns the contents of the <var>i</var>-th bin of the histogram
<var>h</var>.  If <var>i</var> lies outside the valid range of indices for the
histogram then the error handler is called with an error code of
<code>GSL_EDOM</code> and the function returns 0.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fget_005frange"></a><u>Function:</u> int <b>gsl_histogram_get_range</b><i> (const gsl_histogram * <var>h</var>, size_t <var>i</var>, double * <var>lower</var>, double * <var>upper</var>)</i></dt>
<dd><p>This function finds the upper and lower range limits of the <var>i</var>-th
bin of the histogram <var>h</var>.  If the index <var>i</var> is valid then the
corresponding range limits are stored in <var>lower</var> and <var>upper</var>.
The lower limit is inclusive (i.e. events with this coordinate are
included in the bin) and the upper limit is exclusive (i.e. events with
the coordinate of the upper limit are excluded and fall in the
neighboring higher bin, if it exists).  The function returns 0 to
indicate success.  If <var>i</var> lies outside the valid range of indices for
the histogram then the error handler is called and the function returns
an error code of <code>GSL_EDOM</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fmax"></a><u>Function:</u> double <b>gsl_histogram_max</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram_005fmin"></a><u>Function:</u> double <b>gsl_histogram_min</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram_005fbins"></a><u>Function:</u> size_t <b>gsl_histogram_bins</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>These functions return the maximum upper and minimum lower range limits
and the number of bins of the histogram <var>h</var>.  They provide a way of
determining these values without accessing the <code>gsl_histogram</code>
struct directly.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005freset"></a><u>Function:</u> void <b>gsl_histogram_reset</b><i> (gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function resets all the bins in the histogram <var>h</var> to zero.
</p></dd></dl>

<hr size="6">
<a name="Searching-histogram-ranges"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Updating-and-accessing-histogram-elements" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Histogram-Statistics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Updating-and-accessing-histogram-elements" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Histogram-Statistics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Searching-histogram-ranges-1"></a>
<h2 class="section">5. Searching histogram ranges</h2>

<p>The following functions are used by the access and update routines to
locate the bin which corresponds to a given <em>x</em> coordinate.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram_005ffind"></a><u>Function:</u> int <b>gsl_histogram_find</b><i> (const gsl_histogram * <var>h</var>, double <var>x</var>, size_t * <var>i</var>)</i></dt>
<dd><p>This function finds and sets the index <var>i</var> to the bin number which
covers the coordinate <var>x</var> in the histogram <var>h</var>.  The bin is
located using a binary search. The search includes an optimization for
histograms with uniform range, and will return the correct bin
immediately in this case.  If <var>x</var> is found in the range of the
histogram then the function sets the index <var>i</var> and returns
<code>GSL_SUCCESS</code>.  If <var>x</var> lies outside the valid range of the
histogram then the function returns <code>GSL_EDOM</code> and the error
handler is invoked.
</p></dd></dl>

<hr size="6">
<a name="Histogram-Statistics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Searching-histogram-ranges" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Histogram-Operations" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Searching-histogram-ranges" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Histogram-Operations" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Histogram-Statistics-1"></a>
<h2 class="section">6. Histogram Statistics</h2>
<a name="index-histogram-statistics"></a>
<a name="index-statistics_002c-from-histogram"></a>
<a name="index-maximum-value_002c-from-histogram"></a>
<a name="index-minimum-value_002c-from-histogram"></a>
<dl>
<dt><a name="index-gsl_005fhistogram_005fmax_005fval"></a><u>Function:</u> double <b>gsl_histogram_max_val</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the maximum value contained in the histogram bins.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fmax_005fbin"></a><u>Function:</u> size_t <b>gsl_histogram_max_bin</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the index of the bin containing the maximum
value. In the case where several bins contain the same maximum value the
smallest index is returned.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fmin_005fval"></a><u>Function:</u> double <b>gsl_histogram_min_val</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the minimum value contained in the histogram bins.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fmin_005fbin"></a><u>Function:</u> size_t <b>gsl_histogram_min_bin</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the index of the bin containing the minimum
value. In the case where several bins contain the same maximum value the
smallest index is returned.
</p></dd></dl>

<a name="index-mean-value_002c-from-histogram"></a>
<dl>
<dt><a name="index-gsl_005fhistogram_005fmean"></a><u>Function:</u> double <b>gsl_histogram_mean</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the mean of the histogrammed variable, where the
histogram is regarded as a probability distribution. Negative bin values
are ignored for the purposes of this calculation.  The accuracy of the
result is limited by the bin width.
</p></dd></dl>

<a name="index-standard-deviation_002c-from-histogram"></a>
<a name="index-variance_002c-from-histogram"></a>
<dl>
<dt><a name="index-gsl_005fhistogram_005fsigma"></a><u>Function:</u> double <b>gsl_histogram_sigma</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the standard deviation of the histogrammed
variable, where the histogram is regarded as a probability
distribution. Negative bin values are ignored for the purposes of this
calculation. The accuracy of the result is limited by the bin width.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fsum"></a><u>Function:</u> double <b>gsl_histogram_sum</b><i> (const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function returns the sum of all bin values. Negative bin values
are included in the sum.
</p></dd></dl>

<hr size="6">
<a name="Histogram-Operations"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Histogram-Statistics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-and-writing-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Histogram-Statistics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-and-writing-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Histogram-Operations-1"></a>
<h2 class="section">7. Histogram Operations</h2>

<dl>
<dt><a name="index-gsl_005fhistogram_005fequal_005fbins_005fp"></a><u>Function:</u> int <b>gsl_histogram_equal_bins_p</b><i> (const gsl_histogram * <var>h1</var>, const gsl_histogram * <var>h2</var>)</i></dt>
<dd><p>This function returns 1 if the all of the individual bin
ranges of the two histograms are identical, and 0
otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fadd"></a><u>Function:</u> int <b>gsl_histogram_add</b><i> (gsl_histogram * <var>h1</var>, const gsl_histogram * <var>h2</var>)</i></dt>
<dd><p>This function adds the contents of the bins in histogram <var>h2</var> to the
corresponding bins of histogram <var>h1</var>,  i.e. <em>h&rsquo;_1(i) = h_1(i) +
h_2(i)</em>.  The two histograms must have identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fsub"></a><u>Function:</u> int <b>gsl_histogram_sub</b><i> (gsl_histogram * <var>h1</var>, const gsl_histogram * <var>h2</var>)</i></dt>
<dd><p>This function subtracts the contents of the bins in histogram <var>h2</var>
from the corresponding bins of histogram <var>h1</var>, i.e. <em>h&rsquo;_1(i) =
h_1(i) - h_2(i)</em>.  The two histograms must have identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fmul"></a><u>Function:</u> int <b>gsl_histogram_mul</b><i> (gsl_histogram * <var>h1</var>, const gsl_histogram * <var>h2</var>)</i></dt>
<dd><p>This function multiplies the contents of the bins of histogram <var>h1</var>
by the contents of the corresponding bins in histogram <var>h2</var>,
i.e. <em>h&rsquo;_1(i) = h_1(i) * h_2(i)</em>.  The two histograms must have
identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fdiv"></a><u>Function:</u> int <b>gsl_histogram_div</b><i> (gsl_histogram * <var>h1</var>, const gsl_histogram * <var>h2</var>)</i></dt>
<dd><p>This function divides the contents of the bins of histogram <var>h1</var> by
the contents of the corresponding bins in histogram <var>h2</var>,
i.e. <em>h&rsquo;_1(i) = h_1(i) / h_2(i)</em>.  The two histograms must have
identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fscale"></a><u>Function:</u> int <b>gsl_histogram_scale</b><i> (gsl_histogram * <var>h</var>, double <var>scale</var>)</i></dt>
<dd><p>This function multiplies the contents of the bins of histogram <var>h</var>
by the constant <var>scale</var>, i.e. <em>h&rsquo;_1(i) = h_1(i) * scale</em>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fshift"></a><u>Function:</u> int <b>gsl_histogram_shift</b><i> (gsl_histogram * <var>h</var>, double <var>offset</var>)</i></dt>
<dd><p>This function shifts the contents of the bins of histogram <var>h</var> by
the constant <var>offset</var>, i.e. <em>h&rsquo;_1(i) = h_1(i) + offset</em>.
</p></dd></dl>

<hr size="6">
<a name="Reading-and-writing-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Histogram-Operations" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Resampling-from-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Histogram-Operations" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Resampling-from-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Reading-and-writing-histograms-1"></a>
<h2 class="section">8. Reading and writing histograms</h2>

<p>The library provides functions for reading and writing histograms to a file
as binary data or formatted text.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram_005ffwrite"></a><u>Function:</u> int <b>gsl_histogram_fwrite</b><i> (FILE * <var>stream</var>, const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function writes the ranges and bins of the histogram <var>h</var> to the
stream <var>stream</var> in binary format.  The return value is 0 for success
and <code>GSL_EFAILED</code> if there was a problem writing to the file.  Since
the data is written in the native binary format it may not be portable
between different architectures.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005ffread"></a><u>Function:</u> int <b>gsl_histogram_fread</b><i> (FILE * <var>stream</var>, gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function reads into the histogram <var>h</var> from the open stream
<var>stream</var> in binary format.  The histogram <var>h</var> must be
preallocated with the correct size since the function uses the number of
bins in <var>h</var> to determine how many bytes to read.  The return value is
0 for success and <code>GSL_EFAILED</code> if there was a problem reading from
the file.  The data is assumed to have been written in the native binary
format on the same architecture.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005ffprintf"></a><u>Function:</u> int <b>gsl_histogram_fprintf</b><i> (FILE * <var>stream</var>, const gsl_histogram * <var>h</var>, const char * <var>range_format</var>, const char * <var>bin_format</var>)</i></dt>
<dd><p>This function writes the ranges and bins of the histogram <var>h</var>
line-by-line to the stream <var>stream</var> using the format specifiers
<var>range_format</var> and <var>bin_format</var>.  These should be one of the
<code>%g</code>, <code>%e</code> or <code>%f</code> formats for floating point
numbers.  The function returns 0 for success and <code>GSL_EFAILED</code> if
there was a problem writing to the file.  The histogram output is
formatted in three columns, and the columns are separated by spaces,
like this,
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">range[0] range[1] bin[0]
range[1] range[2] bin[1]
range[2] range[3] bin[2]
....
range[n-1] range[n] bin[n-1]
</pre></td></tr></table>

<p>The values of the ranges are formatted using <var>range_format</var> and the
value of the bins are formatted using <var>bin_format</var>.  Each line
contains the lower and upper limit of the range of the bins and the
value of the bin itself.  Since the upper limit of one bin is the lower
limit of the next there is duplication of these values between lines but
this allows the histogram to be manipulated with line-oriented tools.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005ffscanf"></a><u>Function:</u> int <b>gsl_histogram_fscanf</b><i> (FILE * <var>stream</var>, gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function reads formatted data from the stream <var>stream</var> into the
histogram <var>h</var>.  The data is assumed to be in the three-column format
used by <code>gsl_histogram_fprintf</code>.  The histogram <var>h</var> must be
preallocated with the correct length since the function uses the size of
<var>h</var> to determine how many numbers to read.  The function returns 0
for success and <code>GSL_EFAILED</code> if there was a problem reading from
the file.
</p></dd></dl>

<hr size="6">
<a name="Resampling-from-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reading-and-writing-histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-probability-distribution-struct" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-and-writing-histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-probability-distribution-struct" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Resampling-from-histograms-1"></a>
<h2 class="section">9. Resampling from histograms</h2>
<a name="index-resampling-from-histograms"></a>
<a name="index-sampling-from-histograms"></a>
<a name="index-probability-distributions_002c-from-histograms"></a>

<p>A histogram made by counting events can be regarded as a measurement of
a probability distribution.  Allowing for statistical error, the height
of each bin represents the probability of an event where the value of
<em>x</em> falls in the range of that bin.  The probability distribution
function has the one-dimensional form <em>p(x)dx</em> where,
In this equation <em>n_i</em> is the number of events in the bin which
contains <em>x</em>, <em>w_i</em> is the width of the bin and <em>N</em> is
the total number of events.  The distribution of events within each bin
is assumed to be uniform.
</p>
<hr size="6">
<a name="The-histogram-probability-distribution-struct"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Resampling-from-histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Example-programs-for-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Resampling-from-histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Example-programs-for-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-histogram-probability-distribution-struct-1"></a>
<h2 class="section">10. The histogram probability distribution struct</h2>
<a name="index-probability-distribution_002c-from-histogram"></a>
<a name="index-sampling-from-histograms-1"></a>
<a name="index-random-sampling-from-histograms"></a>
<a name="index-histograms_002c-random-sampling-from"></a>
<p>The probability distribution function for a histogram consists of a set
of <em>bins</em> which measure the probability of an event falling into a
given range of a continuous variable <em>x</em>. A probability
distribution function is defined by the following struct, which actually
stores the cumulative probability distribution function.  This is the
natural quantity for generating samples via the inverse transform
method, because there is a one-to-one mapping between the cumulative
probability distribution and the range [0,1].  It can be shown that by
taking a uniform random number in this range and finding its
corresponding coordinate in the cumulative probability distribution we
obtain samples with the desired probability distribution.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram_005fpdf"></a><u>Data Type:</u> <b>gsl_histogram_pdf</b></dt>
<dd><dl compact="compact">
<dt> <code>size_t n</code></dt>
<dd><p>This is the number of bins used to approximate the probability
distribution function. 
</p></dd>
<dt> <code>double * range</code></dt>
<dd><p>The ranges of the bins are stored in an array of <em><var>n</var>+1</em> elements
pointed to by <var>range</var>.
</p></dd>
<dt> <code>double * sum</code></dt>
<dd><p>The cumulative probability for the bins is stored in an array of
<var>n</var> elements pointed to by <var>sum</var>.
</p></dd>
</dl>
</dd></dl>

<p>The following functions allow you to create a <code>gsl_histogram_pdf</code>
struct which represents this probability distribution and generate
random samples from it.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram_005fpdf_005falloc"></a><u>Function:</u> gsl_histogram_pdf * <b>gsl_histogram_pdf_alloc</b><i> (size_t <var>n</var>)</i></dt>
<dd><p>This function allocates memory for a probability distribution with
<var>n</var> bins and returns a pointer to a newly initialized
<code>gsl_histogram_pdf</code> struct. If insufficient memory is available a
null pointer is returned and the error handler is invoked with an error
code of <code>GSL_ENOMEM</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fpdf_005finit"></a><u>Function:</u> int <b>gsl_histogram_pdf_init</b><i> (gsl_histogram_pdf * <var>p</var>, const gsl_histogram * <var>h</var>)</i></dt>
<dd><p>This function initializes the probability distribution <var>p</var> with
the contents of the histogram <var>h</var>. If any of the bins of <var>h</var> are
negative then the error handler is invoked with an error code of
<code>GSL_EDOM</code> because a probability distribution cannot contain
negative values.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fpdf_005ffree"></a><u>Function:</u> void <b>gsl_histogram_pdf_free</b><i> (gsl_histogram_pdf * <var>p</var>)</i></dt>
<dd><p>This function frees the probability distribution function <var>p</var> and
all of the memory associated with it.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram_005fpdf_005fsample"></a><u>Function:</u> double <b>gsl_histogram_pdf_sample</b><i> (const gsl_histogram_pdf * <var>p</var>, double <var>r</var>)</i></dt>
<dd><p>This function uses <var>r</var>, a uniform random number between zero and
one, to compute a single random sample from the probability distribution
<var>p</var>.  The algorithm used to compute the sample <em>s</em> is given by
the following formula,
where <em>i</em> is the index which satisfies 
<em>sum[i] &lt;=  r &lt; sum[i+1]</em> and 
<em>delta</em> is 
<em>(r - sum[i])/(sum[i+1] - sum[i])</em>.
</p></dd></dl>

<hr size="6">
<a name="Example-programs-for-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-histogram-probability-distribution-struct" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Two-dimensional-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-probability-distribution-struct" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Two-dimensional-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Example-programs-for-histograms-1"></a>
<h2 class="section">11. Example programs for histograms</h2>

<p>The following program shows how to make a simple histogram of a column
of numerical data supplied on <code>stdin</code>.  The program takes three
arguments, specifying the upper and lower bounds of the histogram and
the number of bins.  It then reads numbers from <code>stdin</code>, one line at
a time, and adds them to the histogram.  When there is no more data to
read it prints out the accumulated histogram using
<code>gsl_histogram_fprintf</code>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"><pre class="verbatim">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;gsl/gsl_histogram.h&gt;

int
main (int argc, char **argv)
{
  double a, b;
  size_t n;

  if (argc != 4)
    {
      printf (&quot;Usage: gsl-histogram xmin xmax n\n&quot;
              &quot;Computes a histogram of the data &quot;
              &quot;on stdin using n bins from xmin &quot;
              &quot;to xmax\n&quot;);
      exit (0);
    }

  a = atof (argv[1]);
  b = atof (argv[2]);
  n = atoi (argv[3]);

  {
    double x;
    gsl_histogram * h = gsl_histogram_alloc (n);
    gsl_histogram_set_ranges_uniform (h, a, b);

    while (fscanf (stdin, &quot;%lg&quot;, &amp;x) == 1)
      {
        gsl_histogram_increment (h, x);
      }
    gsl_histogram_fprintf (stdout, h, &quot;%g&quot;, &quot;%g&quot;);
    gsl_histogram_free (h);
  }
  exit (0);
}
</pre></pre></td></tr></table>

<p>Here is an example of the program in use.  We generate 10000 random
samples from a Cauchy distribution with a width of 30 and histogram
them over the range -100 to 100, using 200 bins.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">$ gsl-randist 0 10000 cauchy 30 
   | gsl-histogram -100 100 200 &gt; histogram.dat
</pre></td></tr></table>

<p>A plot of the resulting histogram shows the familiar shape of the
Cauchy distribution and the fluctuations caused by the finite sample
size.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">$ awk '{print $1, $3 ; print $2, $3}' histogram.dat 
   | graph -T X
</pre></td></tr></table>


<hr size="6">
<a name="Two-dimensional-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Example-programs-for-histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-2D-histogram-struct" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Example-programs-for-histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-2D-histogram-struct" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Two-dimensional-histograms-1"></a>
<h2 class="section">12. Two dimensional histograms</h2>
<a name="index-two-dimensional-histograms"></a>
<a name="index-2D-histograms"></a>

<p>A two dimensional histogram consists of a set of <em>bins</em> which count
the number of events falling in a given area of the <em>(x,y)</em>
plane.  The simplest way to use a two dimensional histogram is to record
two-dimensional position information, <em>n(x,y)</em>.  Another possibility
is to form a <em>joint distribution</em> by recording related
variables.  For example a detector might record both the position of an
event (<em>x</em>) and the amount of energy it deposited <em>E</em>.  These
could be histogrammed as the joint distribution <em>n(x,E)</em>.
</p>
<hr size="6">
<a name="The-2D-histogram-struct"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Two-dimensional-histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-allocation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Two-dimensional-histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-allocation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-2D-histogram-struct-1"></a>
<h2 class="section">13. The 2D histogram struct</h2>

<p>Two dimensional histograms are defined by the following struct,
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d"></a><u>Data Type:</u> <b>gsl_histogram2d</b></dt>
<dd><dl compact="compact">
<dt> <code>size_t nx, ny</code></dt>
<dd><p>This is the number of histogram bins in the x and y directions.
</p></dd>
<dt> <code>double * xrange</code></dt>
<dd><p>The ranges of the bins in the x-direction are stored in an array of
<em><var>nx</var> + 1</em> elements pointed to by <var>xrange</var>.
</p></dd>
<dt> <code>double * yrange</code></dt>
<dd><p>The ranges of the bins in the y-direction are stored in an array of
<em><var>ny</var> + 1</em> elements pointed to by <var>yrange</var>.
</p></dd>
<dt> <code>double * bin</code></dt>
<dd><p>The counts for each bin are stored in an array pointed to by <var>bin</var>.
The bins are floating-point numbers, so you can increment them by
non-integer values if necessary.  The array <var>bin</var> stores the two
dimensional array of bins in a single block of memory according to the
mapping <code>bin(i,j)</code> = <code>bin[i * ny + j]</code>.
</p></dd>
</dl>
</dd></dl>

<p>The range for <code>bin(i,j)</code> is given by <code>xrange[i]</code> to
<code>xrange[i+1]</code> in the x-direction and <code>yrange[j]</code> to
<code>yrange[j+1]</code> in the y-direction.  Each bin is inclusive at the lower
end and exclusive at the upper end.  Mathematically this means that the
bins are defined by the following inequality,
Note that any samples which fall on the upper sides of the histogram are
excluded.  If you want to include these values for the side bins you will
need to add an extra row or column to your histogram.
</p>
<p>The <code>gsl_histogram2d</code> struct and its associated functions are
defined in the header file &lsquo;<tt>gsl_histogram2d.h</tt>&rsquo;.
</p>
<hr size="6">
<a name="g_t2D-Histogram-allocation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-2D-histogram-struct" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Copying-2D-Histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-2D-histogram-struct" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Copying-2D-Histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="g_t2D-Histogram-allocation-1"></a>
<h2 class="section">14. 2D Histogram allocation</h2>

<p>The functions for allocating memory to a 2D histogram follow the style
of <code>malloc</code> and <code>free</code>.  In addition they also perform their
own error checking.  If there is insufficient memory available to
allocate a histogram then the functions call the error handler (with
an error number of <code>GSL_ENOMEM</code>) in addition to returning a null
pointer.  Thus if you use the library error handler to abort your program
then it isn&rsquo;t necessary to check every 2D histogram <code>alloc</code>.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d_005falloc"></a><u>Function:</u> gsl_histogram2d * <b>gsl_histogram2d_alloc</b><i> (size_t <var>nx</var>, size_t <var>ny</var>)</i></dt>
<dd><p>This function allocates memory for a two-dimensional histogram with
<var>nx</var> bins in the x direction and <var>ny</var> bins in the y direction.
The function returns a pointer to a newly created <code>gsl_histogram2d</code>
struct. If insufficient memory is available a null pointer is returned
and the error handler is invoked with an error code of
<code>GSL_ENOMEM</code>. The bins and ranges must be initialized with one of
the functions below before the histogram is ready for use.
</p></dd></dl>


<dl>
<dt><a name="index-gsl_005fhistogram2d_005fset_005franges"></a><u>Function:</u> int <b>gsl_histogram2d_set_ranges</b><i> (gsl_histogram2d * <var>h</var>,  const double <var>xrange</var>[], size_t <var>xsize</var>, const double <var>yrange</var>[], size_t <var>ysize</var>)</i></dt>
<dd><p>This function sets the ranges of the existing histogram <var>h</var> using
the arrays <var>xrange</var> and <var>yrange</var> of size <var>xsize</var> and
<var>ysize</var> respectively.  The values of the histogram bins are reset to
zero.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fset_005franges_005funiform"></a><u>Function:</u> int <b>gsl_histogram2d_set_ranges_uniform</b><i> (gsl_histogram2d * <var>h</var>, double <var>xmin</var>, double <var>xmax</var>, double <var>ymin</var>, double <var>ymax</var>)</i></dt>
<dd><p>This function sets the ranges of the existing histogram <var>h</var> to cover
the ranges <var>xmin</var> to <var>xmax</var> and <var>ymin</var> to <var>ymax</var>
uniformly.  The values of the histogram bins are reset to zero.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005ffree"></a><u>Function:</u> void <b>gsl_histogram2d_free</b><i> (gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function frees the 2D histogram <var>h</var> and all of the memory
associated with it.
</p></dd></dl>

<hr size="6">
<a name="Copying-2D-Histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#g_t2D-Histogram-allocation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Updating-and-accessing-2D-histogram-elements" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-allocation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Updating-and-accessing-2D-histogram-elements" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Copying-2D-Histograms-1"></a>
<h2 class="section">15. Copying 2D Histograms</h2>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fmemcpy"></a><u>Function:</u> int <b>gsl_histogram2d_memcpy</b><i> (gsl_histogram2d * <var>dest</var>, const gsl_histogram2d * <var>src</var>)</i></dt>
<dd><p>This function copies the histogram <var>src</var> into the pre-existing
histogram <var>dest</var>, making <var>dest</var> into an exact copy of <var>src</var>.
The two histograms must be of the same size.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fclone"></a><u>Function:</u> gsl_histogram2d * <b>gsl_histogram2d_clone</b><i> (const gsl_histogram2d * <var>src</var>)</i></dt>
<dd><p>This function returns a pointer to a newly created histogram which is an
exact copy of the histogram <var>src</var>.
</p></dd></dl>

<hr size="6">
<a name="Updating-and-accessing-2D-histogram-elements"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Copying-2D-Histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Searching-2D-histogram-ranges" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Copying-2D-Histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Searching-2D-histogram-ranges" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Updating-and-accessing-2D-histogram-elements-1"></a>
<h2 class="section">16. Updating and accessing 2D histogram elements</h2>

<p>You can access the bins of a two-dimensional histogram either by
specifying a pair of <em>(x,y)</em> coordinates or by using the bin
indices <em>(i,j)</em> directly.  The functions for accessing the histogram
through <em>(x,y)</em> coordinates use binary searches in the x and y
directions to identify the bin which covers the appropriate range.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d_005fincrement"></a><u>Function:</u> int <b>gsl_histogram2d_increment</b><i> (gsl_histogram2d * <var>h</var>, double <var>x</var>, double <var>y</var>)</i></dt>
<dd><p>This function updates the histogram <var>h</var> by adding one (1.0) to the
bin whose x and y ranges contain the coordinates (<var>x</var>,<var>y</var>).
</p>
<p>If the point <em>(x,y)</em> lies inside the valid ranges of the
histogram then the function returns zero to indicate success.  If
<em>(x,y)</em> lies outside the limits of the histogram then the
function returns <code>GSL_EDOM</code>, and none of the bins are modified.  The
error handler is not called, since it is often necessary to compute
histograms for a small range of a larger dataset, ignoring any
coordinates outside the range of interest.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005faccumulate"></a><u>Function:</u> int <b>gsl_histogram2d_accumulate</b><i> (gsl_histogram2d * <var>h</var>, double <var>x</var>, double <var>y</var>, double <var>weight</var>)</i></dt>
<dd><p>This function is similar to <code>gsl_histogram2d_increment</code> but increases
the value of the appropriate bin in the histogram <var>h</var> by the
floating-point number <var>weight</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fget"></a><u>Function:</u> double <b>gsl_histogram2d_get</b><i> (const gsl_histogram2d * <var>h</var>, size_t <var>i</var>, size_t <var>j</var>)</i></dt>
<dd><p>This function returns the contents of the (<var>i</var>,<var>j</var>)-th bin of the
histogram <var>h</var>.  If (<var>i</var>,<var>j</var>) lies outside the valid range of
indices for the histogram then the error handler is called with an error
code of <code>GSL_EDOM</code> and the function returns 0.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fget_005fxrange"></a><u>Function:</u> int <b>gsl_histogram2d_get_xrange</b><i> (const gsl_histogram2d * <var>h</var>, size_t <var>i</var>, double * <var>xlower</var>, double * <var>xupper</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram2d_005fget_005fyrange"></a><u>Function:</u> int <b>gsl_histogram2d_get_yrange</b><i> (const gsl_histogram2d * <var>h</var>, size_t <var>j</var>, double * <var>ylower</var>, double * <var>yupper</var>)</i></dt>
<dd><p>These functions find the upper and lower range limits of the <var>i</var>-th
and <var>j</var>-th bins in the x and y directions of the histogram <var>h</var>.
The range limits are stored in <var>xlower</var> and <var>xupper</var> or
<var>ylower</var> and <var>yupper</var>.  The lower limits are inclusive
(i.e. events with these coordinates are included in the bin) and the
upper limits are exclusive (i.e. events with the value of the upper
limit are not included and fall in the neighboring higher bin, if it
exists).  The functions return 0 to indicate success.  If <var>i</var> or
<var>j</var> lies outside the valid range of indices for the histogram then
the error handler is called with an error code of <code>GSL_EDOM</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fxmax"></a><u>Function:</u> double <b>gsl_histogram2d_xmax</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram2d_005fxmin"></a><u>Function:</u> double <b>gsl_histogram2d_xmin</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram2d_005fnx"></a><u>Function:</u> size_t <b>gsl_histogram2d_nx</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram2d_005fymax"></a><u>Function:</u> double <b>gsl_histogram2d_ymax</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram2d_005fymin"></a><u>Function:</u> double <b>gsl_histogram2d_ymin</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dt><a name="index-gsl_005fhistogram2d_005fny"></a><u>Function:</u> size_t <b>gsl_histogram2d_ny</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>These functions return the maximum upper and minimum lower range limits
and the number of bins for the x and y directions of the histogram
<var>h</var>.  They provide a way of determining these values without
accessing the <code>gsl_histogram2d</code> struct directly.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005freset"></a><u>Function:</u> void <b>gsl_histogram2d_reset</b><i> (gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function resets all the bins of the histogram <var>h</var> to zero.
</p></dd></dl>

<hr size="6">
<a name="Searching-2D-histogram-ranges"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Updating-and-accessing-2D-histogram-elements" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-Statistics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Updating-and-accessing-2D-histogram-elements" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-Statistics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Searching-2D-histogram-ranges-1"></a>
<h2 class="section">17. Searching 2D histogram ranges</h2>

<p>The following functions are used by the access and update routines to
locate the bin which corresponds to a given <em>(x,y)</em> coordinate.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d_005ffind"></a><u>Function:</u> int <b>gsl_histogram2d_find</b><i> (const gsl_histogram2d * <var>h</var>, double <var>x</var>, double <var>y</var>, size_t * <var>i</var>, size_t * <var>j</var>)</i></dt>
<dd><p>This function finds and sets the indices <var>i</var> and <var>j</var> to
the bin which covers the coordinates (<var>x</var>,<var>y</var>). The bin is
located using a binary search.  The search includes an optimization for
histograms with uniform ranges, and will return the correct bin immediately
in this case. If <em>(x,y)</em> is found then the function sets the
indices (<var>i</var>,<var>j</var>) and returns <code>GSL_SUCCESS</code>.  If
<em>(x,y)</em> lies outside the valid range of the histogram then the
function returns <code>GSL_EDOM</code> and the error handler is invoked.
</p></dd></dl>

<hr size="6">
<a name="g_t2D-Histogram-Statistics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Searching-2D-histogram-ranges" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-Operations" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Searching-2D-histogram-ranges" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-Operations" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="g_t2D-Histogram-Statistics-1"></a>
<h2 class="section">18. 2D Histogram Statistics</h2>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fmax_005fval"></a><u>Function:</u> double <b>gsl_histogram2d_max_val</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the maximum value contained in the histogram bins.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fmax_005fbin"></a><u>Function:</u> void <b>gsl_histogram2d_max_bin</b><i> (const gsl_histogram2d * <var>h</var>, size_t * <var>i</var>, size_t * <var>j</var>)</i></dt>
<dd><p>This function finds the indices of the bin containing the maximum value
in the histogram <var>h</var> and stores the result in (<var>i</var>,<var>j</var>). In
the case where several bins contain the same maximum value the first bin
found is returned.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fmin_005fval"></a><u>Function:</u> double <b>gsl_histogram2d_min_val</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the minimum value contained in the histogram bins.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fmin_005fbin"></a><u>Function:</u> void <b>gsl_histogram2d_min_bin</b><i> (const gsl_histogram2d * <var>h</var>, size_t * <var>i</var>, size_t * <var>j</var>)</i></dt>
<dd><p>This function finds the indices of the bin containing the minimum value
in the histogram <var>h</var> and stores the result in (<var>i</var>,<var>j</var>). In
the case where several bins contain the same maximum value the first bin
found is returned.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fxmean"></a><u>Function:</u> double <b>gsl_histogram2d_xmean</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the mean of the histogrammed x variable, where the
histogram is regarded as a probability distribution. Negative bin values
are ignored for the purposes of this calculation.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fymean"></a><u>Function:</u> double <b>gsl_histogram2d_ymean</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the mean of the histogrammed y variable, where the
histogram is regarded as a probability distribution. Negative bin values
are ignored for the purposes of this calculation.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fxsigma"></a><u>Function:</u> double <b>gsl_histogram2d_xsigma</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the standard deviation of the histogrammed
x variable, where the histogram is regarded as a probability
distribution. Negative bin values are ignored for the purposes of this
calculation.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fysigma"></a><u>Function:</u> double <b>gsl_histogram2d_ysigma</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the standard deviation of the histogrammed
y variable, where the histogram is regarded as a probability
distribution. Negative bin values are ignored for the purposes of this
calculation.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fcov"></a><u>Function:</u> double <b>gsl_histogram2d_cov</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the covariance of the histogrammed x and y
variables, where the histogram is regarded as a probability
distribution. Negative bin values are ignored for the purposes of this
calculation.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fsum"></a><u>Function:</u> double <b>gsl_histogram2d_sum</b><i> (const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function returns the sum of all bin values. Negative bin values
are included in the sum.
</p></dd></dl>

<hr size="6">
<a name="g_t2D-Histogram-Operations"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#g_t2D-Histogram-Statistics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-and-writing-2D-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-Statistics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-and-writing-2D-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="g_t2D-Histogram-Operations-1"></a>
<h2 class="section">19. 2D Histogram Operations</h2>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fequal_005fbins_005fp"></a><u>Function:</u> int <b>gsl_histogram2d_equal_bins_p</b><i> (const gsl_histogram2d * <var>h1</var>, const gsl_histogram2d * <var>h2</var>)</i></dt>
<dd><p>This function returns 1 if all the individual bin ranges of the two
histograms are identical, and 0 otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fadd"></a><u>Function:</u> int <b>gsl_histogram2d_add</b><i> (gsl_histogram2d * <var>h1</var>, const gsl_histogram2d * <var>h2</var>)</i></dt>
<dd><p>This function adds the contents of the bins in histogram <var>h2</var> to the
corresponding bins of histogram <var>h1</var>,
i.e. <em>h&rsquo;_1(i,j) = h_1(i,j) + h_2(i,j)</em>.
The two histograms must have identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fsub"></a><u>Function:</u> int <b>gsl_histogram2d_sub</b><i> (gsl_histogram2d * <var>h1</var>, const gsl_histogram2d * <var>h2</var>)</i></dt>
<dd><p>This function subtracts the contents of the bins in histogram <var>h2</var> from the
corresponding bins of histogram <var>h1</var>,
i.e. <em>h&rsquo;_1(i,j) = h_1(i,j) - h_2(i,j)</em>.
The two histograms must have identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fmul"></a><u>Function:</u> int <b>gsl_histogram2d_mul</b><i> (gsl_histogram2d * <var>h1</var>, const gsl_histogram2d * <var>h2</var>)</i></dt>
<dd><p>This function multiplies the contents of the bins of histogram <var>h1</var>
by the contents of the corresponding bins in histogram <var>h2</var>,
i.e. <em>h&rsquo;_1(i,j) = h_1(i,j) * h_2(i,j)</em>.
The two histograms must have identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fdiv"></a><u>Function:</u> int <b>gsl_histogram2d_div</b><i> (gsl_histogram2d * <var>h1</var>, const gsl_histogram2d * <var>h2</var>)</i></dt>
<dd><p>This function divides the contents of the bins of histogram <var>h1</var>
by the contents of the corresponding bins in histogram <var>h2</var>,
i.e. <em>h&rsquo;_1(i,j) = h_1(i,j) / h_2(i,j)</em>.
The two histograms must have identical bin ranges.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fscale"></a><u>Function:</u> int <b>gsl_histogram2d_scale</b><i> (gsl_histogram2d * <var>h</var>, double <var>scale</var>)</i></dt>
<dd><p>This function multiplies the contents of the bins of histogram <var>h</var>
by the constant <var>scale</var>, i.e. <em>h&rsquo;_1(i,j) = h_1(i,j) scale</em>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fshift"></a><u>Function:</u> int <b>gsl_histogram2d_shift</b><i> (gsl_histogram2d * <var>h</var>, double <var>offset</var>)</i></dt>
<dd><p>This function shifts the contents of the bins of histogram <var>h</var>
by the constant <var>offset</var>, i.e. <em>h&rsquo;_1(i,j) = h_1(i,j) + offset</em>.
</p></dd></dl>

<hr size="6">
<a name="Reading-and-writing-2D-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#g_t2D-Histogram-Operations" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Resampling-from-2D-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#g_t2D-Histogram-Operations" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Resampling-from-2D-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Reading-and-writing-2D-histograms-1"></a>
<h2 class="section">20. Reading and writing 2D histograms</h2>

<p>The library provides functions for reading and writing two dimensional
histograms to a file as binary data or formatted text.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d_005ffwrite"></a><u>Function:</u> int <b>gsl_histogram2d_fwrite</b><i> (FILE * <var>stream</var>, const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function writes the ranges and bins of the histogram <var>h</var> to the
stream <var>stream</var> in binary format.  The return value is 0 for success
and <code>GSL_EFAILED</code> if there was a problem writing to the file.  Since
the data is written in the native binary format it may not be portable
between different architectures.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005ffread"></a><u>Function:</u> int <b>gsl_histogram2d_fread</b><i> (FILE * <var>stream</var>, gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function reads into the histogram <var>h</var> from the stream
<var>stream</var> in binary format.  The histogram <var>h</var> must be
preallocated with the correct size since the function uses the number of
x and y bins in <var>h</var> to determine how many bytes to read.  The return
value is 0 for success and <code>GSL_EFAILED</code> if there was a problem
reading from the file.  The data is assumed to have been written in the
native binary format on the same architecture.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005ffprintf"></a><u>Function:</u> int <b>gsl_histogram2d_fprintf</b><i> (FILE * <var>stream</var>, const gsl_histogram2d * <var>h</var>, const char * <var>range_format</var>, const char * <var>bin_format</var>)</i></dt>
<dd><p>This function writes the ranges and bins of the histogram <var>h</var>
line-by-line to the stream <var>stream</var> using the format specifiers
<var>range_format</var> and <var>bin_format</var>.  These should be one of the
<code>%g</code>, <code>%e</code> or <code>%f</code> formats for floating point
numbers.  The function returns 0 for success and <code>GSL_EFAILED</code> if
there was a problem writing to the file.  The histogram output is
formatted in five columns, and the columns are separated by spaces,
like this,
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">xrange[0] xrange[1] yrange[0] yrange[1] bin(0,0)
xrange[0] xrange[1] yrange[1] yrange[2] bin(0,1)
xrange[0] xrange[1] yrange[2] yrange[3] bin(0,2)
....
xrange[0] xrange[1] yrange[ny-1] yrange[ny] bin(0,ny-1)

xrange[1] xrange[2] yrange[0] yrange[1] bin(1,0)
xrange[1] xrange[2] yrange[1] yrange[2] bin(1,1)
xrange[1] xrange[2] yrange[1] yrange[2] bin(1,2)
....
xrange[1] xrange[2] yrange[ny-1] yrange[ny] bin(1,ny-1)

....

xrange[nx-1] xrange[nx] yrange[0] yrange[1] bin(nx-1,0)
xrange[nx-1] xrange[nx] yrange[1] yrange[2] bin(nx-1,1)
xrange[nx-1] xrange[nx] yrange[1] yrange[2] bin(nx-1,2)
....
xrange[nx-1] xrange[nx] yrange[ny-1] yrange[ny] bin(nx-1,ny-1)
</pre></td></tr></table>

<p>Each line contains the lower and upper limits of the bin and the
contents of the bin.  Since the upper limits of the each bin are the
lower limits of the neighboring bins there is duplication of these
values but this allows the histogram to be manipulated with
line-oriented tools.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005ffscanf"></a><u>Function:</u> int <b>gsl_histogram2d_fscanf</b><i> (FILE * <var>stream</var>, gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function reads formatted data from the stream <var>stream</var> into the
histogram <var>h</var>.  The data is assumed to be in the five-column format
used by <code>gsl_histogram2d_fprintf</code>.  The histogram <var>h</var> must be
preallocated with the correct lengths since the function uses the sizes
of <var>h</var> to determine how many numbers to read.  The function returns 0
for success and <code>GSL_EFAILED</code> if there was a problem reading from
the file.
</p></dd></dl>

<hr size="6">
<a name="Resampling-from-2D-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reading-and-writing-2D-histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Example-programs-for-2D-histograms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-and-writing-2D-histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Example-programs-for-2D-histograms" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Resampling-from-2D-histograms-1"></a>
<h2 class="section">21. Resampling from 2D histograms</h2>

<p>As in the one-dimensional case, a two-dimensional histogram made by
counting events can be regarded as a measurement of a probability
distribution.  Allowing for statistical error, the height of each bin
represents the probability of an event where (<em>x</em>,<em>y</em>) falls in
the range of that bin.  For a two-dimensional histogram the probability
distribution takes the form <em>p(x,y) dx dy</em> where,
In this equation 
<em>n_ij</em> is the number of events in the bin which
contains <em>(x,y)</em>, 
<em>A_ij</em> is the area of the bin and <em>N</em> is
the total number of events.  The distribution of events within each bin
is assumed to be uniform.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d_005fpdf"></a><u>Data Type:</u> <b>gsl_histogram2d_pdf</b></dt>
<dd><dl compact="compact">
<dt> <code>size_t nx, ny</code></dt>
<dd><p>This is the number of histogram bins used to approximate the probability
distribution function in the x and y directions.
</p></dd>
<dt> <code>double * xrange</code></dt>
<dd><p>The ranges of the bins in the x-direction are stored in an array of
<em><var>nx</var> + 1</em> elements pointed to by <var>xrange</var>.
</p></dd>
<dt> <code>double * yrange</code></dt>
<dd><p>The ranges of the bins in the y-direction are stored in an array of
<em><var>ny</var> + 1</em> pointed to by <var>yrange</var>.
</p></dd>
<dt> <code>double * sum</code></dt>
<dd><p>The cumulative probability for the bins is stored in an array of
<var>nx</var>*<var>ny</var> elements pointed to by <var>sum</var>.
</p></dd>
</dl>
</dd></dl>

<p>The following functions allow you to create a <code>gsl_histogram2d_pdf</code>
struct which represents a two dimensional probability distribution and
generate random samples from it.
</p>
<dl>
<dt><a name="index-gsl_005fhistogram2d_005fpdf_005falloc"></a><u>Function:</u> gsl_histogram2d_pdf * <b>gsl_histogram2d_pdf_alloc</b><i> (size_t <var>nx</var>, size_t <var>ny</var>)</i></dt>
<dd><p>This function allocates memory for a two-dimensional probability
distribution of size <var>nx</var>-by-<var>ny</var> and returns a pointer to a
newly initialized <code>gsl_histogram2d_pdf</code> struct. If insufficient
memory is available a null pointer is returned and the error handler is
invoked with an error code of <code>GSL_ENOMEM</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fpdf_005finit"></a><u>Function:</u> int <b>gsl_histogram2d_pdf_init</b><i> (gsl_histogram2d_pdf * <var>p</var>, const gsl_histogram2d * <var>h</var>)</i></dt>
<dd><p>This function initializes the two-dimensional probability distribution
calculated <var>p</var> from the histogram <var>h</var>.  If any of the bins of
<var>h</var> are negative then the error handler is invoked with an error
code of <code>GSL_EDOM</code> because a probability distribution cannot
contain negative values.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fpdf_005ffree"></a><u>Function:</u> void <b>gsl_histogram2d_pdf_free</b><i> (gsl_histogram2d_pdf * <var>p</var>)</i></dt>
<dd><p>This function frees the two-dimensional probability distribution
function <var>p</var> and all of the memory associated with it.
</p></dd></dl>

<dl>
<dt><a name="index-gsl_005fhistogram2d_005fpdf_005fsample"></a><u>Function:</u> int <b>gsl_histogram2d_pdf_sample</b><i> (const gsl_histogram2d_pdf * <var>p</var>, double <var>r1</var>, double <var>r2</var>, double * <var>x</var>, double * <var>y</var>)</i></dt>
<dd><p>This function uses two uniform random numbers between zero and one,
<var>r1</var> and <var>r2</var>, to compute a single random sample from the
two-dimensional probability distribution <var>p</var>.
</p></dd></dl>


<hr size="6">
<a name="Example-programs-for-2D-histograms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Resampling-from-2D-histograms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Resampling-from-2D-histograms" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Example-programs-for-2D-histograms-1"></a>
<h2 class="section">22. Example programs for 2D histograms</h2>
<p>This program demonstrates two features of two-dimensional histograms.
First a 10-by-10 two-dimensional histogram is created with x and y running
from 0 to 1.  Then a few sample points are added to the histogram, at
(0.3,0.3) with a height of 1, at (0.8,0.1) with a height of 5 and at
(0.7,0.9) with a height of 0.5.  This histogram with three events is
used to generate a random sample of 1000 simulated events, which are
printed out.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"><pre class="verbatim">#include &lt;stdio.h&gt;
#include &lt;gsl/gsl_rng.h&gt;
#include &lt;gsl/gsl_histogram2d.h&gt;

int
main (void)
{
  const gsl_rng_type * T;
  gsl_rng * r;

  gsl_histogram2d * h = gsl_histogram2d_alloc (10, 10);

  gsl_histogram2d_set_ranges_uniform (h, 
                                      0.0, 1.0,
                                      0.0, 1.0);

  gsl_histogram2d_accumulate (h, 0.3, 0.3, 1);
  gsl_histogram2d_accumulate (h, 0.8, 0.1, 5);
  gsl_histogram2d_accumulate (h, 0.7, 0.9, 0.5);

  gsl_rng_env_setup ();
  
  T = gsl_rng_default;
  r = gsl_rng_alloc (T);

  {
    int i;
    gsl_histogram2d_pdf * p 
      = gsl_histogram2d_pdf_alloc (h-&gt;nx, h-&gt;ny);
    
    gsl_histogram2d_pdf_init (p, h);

    for (i = 0; i &lt; 1000; i++) {
      double x, y;
      double u = gsl_rng_uniform (r);
      double v = gsl_rng_uniform (r);
       
      gsl_histogram2d_pdf_sample (p, u, v, &amp;x, &amp;y);
      
      printf (&quot;%g %g\n&quot;, x, y);
    }

    gsl_histogram2d_pdf_free (p);
  }

  gsl_histogram2d_free (h);
  gsl_rng_free (r);

  return 0;
}
</pre></pre></td></tr></table>


<hr size="6">
<a name="SEC_About"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-histogram-struct" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[Contents]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>
<p>
  This document was generated by <em>A. Gerow</em> on <em>April 2, 2015</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr size="1">
<p>
 <font size="-1">
  This document was generated by <em>A. Gerow</em> on <em>April 2, 2015</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
